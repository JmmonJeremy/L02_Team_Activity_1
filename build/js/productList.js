var o=(d,r,e)=>new Promise((t,s)=>{var c=a=>{try{i(e.next(a))}catch(n){s(n)}},l=a=>{try{i(e.throw(a))}catch(n){s(n)}},i=a=>a.done?t(a.value):Promise.resolve(a.value).then(c,l);i((e=e.apply(d,r)).next())});import{loadTemplate as u,renderListWithTemplate as g}from"./utils.js";export default class y{constructor(r,e,t){this.category=r,this.dataSource=e,this.listElement=t}init(r=!1){return o(this,null,function*(){const e=yield this.dataSource.getData(this.category);let t=[];r?t=e.sort((s,c)=>s.ListPrice-c.ListPrice):t=e.sort((s,c)=>s.NameWithoutBrand.localeCompare(c.NameWithoutBrand)),document.querySelector(".products>h2").innerHTML=`Top Products: ${(this.category.charAt(0).toUpperCase()+this.category.slice(1)).replace("-b"," B")}`,document.querySelector(".product-breadcrumb").innerHTML=`${this.category.charAt(0).toUpperCase()+this.category.slice(1)} (${t.length} items)`,this.renderList(t).then(s=>this.runModal())})}renderList(r){return o(this,null,function*(){this.listElement.innerHTML="";const e=yield u("../partials/product-card-template.html");g(e,this.listElement,r,this.prepareTemplate)})}prepareTemplate(r,e){r.querySelector("a").href+=e.Id,r.querySelector("img").src=e.Images.PrimaryMedium,r.querySelector("img").alt+=e.Name,r.querySelector(".card__brand").innerHTML=e.Brand.Name,r.querySelector(".card__name").innerHTML=e.NameWithoutBrand,r.querySelector(".base_discount-flag").alt="discount flag star",r.querySelector(".base_discount-flag").src="../images/discount.svg",r.querySelector(".base_flag-percent").innerHTML=100-Math.ceil(e.ListPrice/e.SuggestedRetailPrice*100),r.querySelector(".base__orginal-price").innerHTML+=e.SuggestedRetailPrice.toFixed(2),r.querySelector(".base__discount").innerHTML+=(e.SuggestedRetailPrice-e.ListPrice).toFixed(2)+"!!!",r.querySelector(".base-highlight").innerHTML+=e.FinalPrice,r.querySelector(".product-detail>h3").innerHTML=e.Brand.Name,r.querySelector(".product-detail>h2").innerHTML=e.NameWithoutBrand,r.querySelector(".product-detail>img").alt=e.NameWithoutBrand,r.querySelector(".product-detail>img").src=e.Images.PrimaryLarge,r.querySelector(".discount-flag").alt="discount flag star",r.querySelector(".discount-flag").src="../images/discount.svg",r.querySelector(".flag-percent").innerHTML=100-Math.ceil(e.ListPrice/e.SuggestedRetailPrice*100),r.querySelector(".product-card__orginal-price").innerHTML+=e.SuggestedRetailPrice.toFixed(2),r.querySelector(".product-card__discount").innerHTML+=(e.SuggestedRetailPrice-e.ListPrice).toFixed(2)+"!!!",r.querySelector(".price-highlight").innerHTML+=e.FinalPrice,r.querySelector(".product__color").innerHTML+=e.Colors[0].ColorName,r.querySelector(".product__description").innerHTML+=e.DescriptionHtmlSimple,r.querySelector(".product__reviews").innerHTML+=e.Reviews.ReviewCount,r.querySelector(".product__ratings").innerHTML+=e.Reviews.AverageRating;let t=r.getElementById("comment");return t.addEventListener("click",()=>{e.Id&&(location.href=`../product_pages/product-details.html?product=${e.Id}`)}),r}runModal(){let r,e=document.querySelectorAll(".modal"),t=0;e.forEach(i=>{i.setAttribute("data-id","match"+t),t++});let s=document.querySelectorAll(".details-btn"),c=0;s.forEach(i=>{i.id="details-btn"+c,i.setAttribute("data-id","match"+c);let a=document.getElementById("details-btn"+c);a.onclick=function(){e.forEach(n=>{n.getAttribute("data-id")==a.getAttribute("data-id")&&(r=n)}),r.style.display="block"},c++});let l=document.querySelectorAll(".close");l.forEach(i=>{i.onclick=function(){r.style.display="none"}}),window.onclick=function(i){i.target==r&&(r.style.display="none")}}}
